# API一覧

## 文書情報

| 項目 | 内容 |
|:---|:---|
| **作成日** | 2025-12-09 |
| **最終更新日** | 2025-12-10 |
| **バージョン** | 1.1.0 |

---

## 1. API一覧

### 1.1 タスク管理API

| API ID | API名 | HTTPメソッド | エンドポイント | 機能概要 | 設計書 |
|:---|:---|:---|:---|:---|:---|
| API-TASK-001 | タスク一覧取得 | GET | `/tasks` | タスク一覧を取得する。ステータス、優先度、カテゴリーIDによる絞り込み検索が可能。 | [設計書](API設計書/API-TASK-001_タスク一覧取得.md) |
| API-TASK-002 | タスク詳細取得 | GET | `/tasks/{id}` | 指定されたIDのタスク詳細情報を取得する。 | [設計書](API設計書/API-TASK-002_タスク詳細取得.md) |
| API-TASK-003 | タスク登録フォーム表示 | GET | `/tasks/new` | タスク登録フォーム画面を表示する。マスタデータ（TaskForm）を渡して初期表示を行う。 | [設計書](API設計書/API-TASK-003_タスク登録フォーム表示.md) |
| API-TASK-004 | タスク登録 | POST | `/tasks` | 新規タスクをデータベースに登録する。バリデーションを実施し、成功時は詳細画面へリダイレクトする。 | [設計書](API設計書/API-TASK-004_タスク登録.md) |
| API-TASK-005 | タスク編集フォーム表示 | GET | `/tasks/{id}/edit` | 指定されたIDのタスクの編集フォーム画面を表示する。既存データをTaskFormに詰め替えてフォームに渡す。 | [設計書](API設計書/API-TASK-005_タスク編集フォーム表示.md) |
| API-TASK-006 | タスク更新 | POST | `/tasks/{id}` | 既存タスクの情報を更新する。バリデーションを実施し、成功時は詳細画面へリダイレクトする。 | [設計書](API設計書/API-TASK-006_タスク更新.md) |
| API-TASK-007 | タスク削除 | POST | `/tasks/{id}/delete` | 指定されたIDのタスクを論理的に削除する。削除成功後は一覧画面へリダイレクトする。 | [設計書](API設計書/API-TASK-007_タスク削除.md) |

### 1.2 カテゴリー管理API

| API ID | API名 | HTTPメソッド | エンドポイント | 機能概要 | 設計書 |
|:---|:---|:---|:---|:---|:---|
| API-CAT-001 | カテゴリー一覧取得 | GET | `/categories` | カテゴリー一覧を取得する。表示順（display_order）でソートされる。 | [設計書](API設計書/API-CAT-001_カテゴリー一覧取得.md) |
| API-CAT-002 | カテゴリー登録フォーム表示 | GET | `/categories/new` | カテゴリー登録フォーム画面を表示する。初期値（color=#6c757d, displayOrder=0）を設定する。 | [設計書](API設計書/API-CAT-002_カテゴリー登録フォーム表示.md) |
| API-CAT-003 | カテゴリー作成 | POST | `/categories` | 新規カテゴリーをデータベースに登録する。バリデーションを実施し、成功時は一覧画面へリダイレクトする。 | [設計書](API設計書/API-CAT-003_カテゴリー作成.md) |
| API-CAT-004 | カテゴリー編集フォーム表示 | GET | `/categories/{id}/edit` | 指定されたIDのカテゴリーの編集フォーム画面を表示する。既存データをCategoryFormに詰め替えてフォームに渡す。 | [設計書](API設計書/API-CAT-004_カテゴリー編集フォーム表示.md) |
| API-CAT-005 | カテゴリー更新 | POST | `/categories/{id}` | 既存カテゴリー情報を更新する。バリデーションを実施し、成功時は一覧画面へリダイレクトする。 | [設計書](API設計書/API-CAT-005_カテゴリー更新.md) |
| API-CAT-006 | カテゴリー削除 | POST | `/categories/{id}/delete` | 指定されたIDのカテゴリーを削除する。削除前にタスクとの関連をチェックし、使用中の場合は削除不可とする。 | [設計書](API設計書/API-CAT-006_カテゴリー削除.md) |

---

## 2. エンドポイント別HTTPメソッド対応表

### 2.1 GET

| エンドポイント | API ID | API名 | 機能概要 |
|:---|:---|:---|:---|
| `/tasks` | API-TASK-001 | タスク一覧取得 | タスク一覧を取得する（絞り込み可能） |
| `/tasks/{id}` | API-TASK-002 | タスク詳細取得 | タスク詳細情報を取得する |
| `/tasks/new` | API-TASK-003 | タスク登録フォーム表示 | タスク登録フォーム画面を表示する |
| `/tasks/{id}/edit` | API-TASK-005 | タスク編集フォーム表示 | タスク編集フォーム画面を表示する |
| `/categories` | API-CAT-001 | カテゴリー一覧取得 | カテゴリー一覧を取得する |
| `/categories/new` | API-CAT-002 | カテゴリー登録フォーム表示 | カテゴリー登録フォーム画面を表示する |
| `/categories/{id}/edit` | API-CAT-004 | カテゴリー編集フォーム表示 | カテゴリー編集フォーム画面を表示する |

### 2.2 POST

| エンドポイント | API ID | API名 | 機能概要 |
|:---|:---|:---|:---|
| `/tasks` | API-TASK-004 | タスク登録 | 新規タスクを登録する |
| `/tasks/{id}` | API-TASK-006 | タスク更新 | タスク情報を更新する |
| `/tasks/{id}/delete` | API-TASK-007 | タスク削除 | タスクを削除する |
| `/categories` | API-CAT-003 | カテゴリー作成 | 新規カテゴリーを作成する |
| `/categories/{id}` | API-CAT-005 | カテゴリー更新 | カテゴリー情報を更新する |
| `/categories/{id}/delete` | API-CAT-006 | カテゴリー削除 | カテゴリーを削除する |

---

## 3. 画面とAPIの対応関係

| 画面ID | 画面名 | 使用API |
|:---|:---|:---|
| SCR-TASK-001 | タスク一覧 | API-TASK-001（タスク一覧取得） |
| SCR-TASK-002 | タスク登録 | API-TASK-003（フォーム表示）、API-TASK-004（登録） |
| SCR-TASK-003 | タスク詳細 | API-TASK-002（詳細取得）、API-TASK-007（削除） |
| SCR-TASK-004 | タスク編集 | API-TASK-005（フォーム表示）、API-TASK-006（更新） |
| SCR-CAT-001 | カテゴリー一覧 | API-CAT-001（カテゴリー一覧取得）、API-CAT-006（カテゴリー削除） |
| SCR-CAT-002 | カテゴリー登録 | API-CAT-002（カテゴリー登録フォーム表示）、API-CAT-003（カテゴリー作成） |
| SCR-CAT-003 | カテゴリー編集 | API-CAT-004（カテゴリー編集フォーム表示）、API-CAT-005（カテゴリー更新） |

---

## 4. 共通仕様

### 4.1 認証・認可

- **現状**: 認証・認可は実装しない（将来拡張予定）
- **将来**: Spring Security を使用した認証・認可を実装

### 4.2 エラーレスポンス

| HTTPステータス | 名称 | 説明 |
|:---|:---|:---|
| 400 Bad Request | 不正なリクエスト | バリデーションエラー等 |
| 404 Not Found | リソースが見つからない | タスクIDが存在しない等 |
| 500 Internal Server Error | サーバーエラー | データベースエラー等 |

### 4.3 バリデーション

- **フレームワーク**: Jakarta Validation (Bean Validation 3.0)
- **使用アノテーション**: @NotBlank, @NotNull, @Size, @DateTimeFormat, @Pattern, @Min
- **エラー表示**: Thymeleafテンプレートでバインディング結果（BindingResult）を使用

### 4.4 トランザクション制御

- **管理方法**: Spring @Transactional アノテーションによる宣言的トランザクション
- **対象**: データ更新API（登録・更新・削除）
- **分離レベル**: デフォルト（READ_COMMITTED）

### 4.5 使用技術

| カテゴリー | 技術 | 用途 |
|:---|:---|:---|
| Webフレームワーク | Spring Boot 3.4.9 | Web アプリケーション基盤 |
| テンプレートエンジン | Thymeleaf | 画面レンダリング |
| O/Rマッパー | MyBatis 3.0.3 | データベースアクセス |
| データベース | H2 Database | 組み込み型DB |
| バリデーション | Jakarta Validation | 入力値検証 |
| マッピング | MapStruct 1.5.5 | DTO/Entity/Form 変換 |

---

## 5. 変更履歴

| バージョン | 変更日 | 変更内容 |
|:---|:---|:---|
| 1.0.0 | 2025-12-09 | 初版作成（タスク管理API 7件） |
| 1.1.0 | 2025-12-10 | カテゴリー管理API 6件を追加（API-CAT-001〜006） |
